---
jupyter:
  accelerator: GPU
  colab:
    gpuType: T4
    toc_visible: true
  kernelspec:
    display_name: Python 3
    name: python3
  language_info:
    name: python
  nbformat: 4
  nbformat_minor: 0
  widgets:
    application/vnd.jupyter.widget-state+json:
      0033d05b70d24f6292263656a4438a60:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      0039893eed314ae79d5a0d154534847c:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      0057a594fe344e44a69aec4d8e3cb077:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      015a5dbabf014942b881ad855c3e851f:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      04945b8c13554a608373f508003590ae:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      0b1c2ffe6b77416198c12550a9eb070e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ButtonModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ButtonModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ButtonView
          description: Login
          disabled: false
          layout: IPY_MODEL_aae2d90a359e489fbd6004eacd13c38a
          style: IPY_MODEL_2d2c042edf614fcfbe76a6d4596f5cd9
      0c52c7be1ab34cfaba33085ad5a531b3:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      0c8d72f028064ea39e8a767e78cbaf63:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      10a69bdc130a4fa7b52d7aa8aa54d53e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      1563563eb07342bbb4c2e6e52d43bf67:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      157e6fc33595471e98ca7a5bba80e337:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      1c64786c92c3441a8c069aca1f20ca53:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      1d6077981a8c43bf91817e1ed42e144a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      1dc6c4be17c84dd5b266953c978a27e1:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_0c8d72f028064ea39e8a767e78cbaf63
          placeholder: ​
          style: IPY_MODEL_10a69bdc130a4fa7b52d7aa8aa54d53e
          value: "tokenizer.json: "
      2080e3b6ac1849bda448be6d8fd4bc97:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_4c3652fdfd0a46fb8cca417e048b4a55
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_5e6902ec46b54bd19abed1cef05a8cf9
          value: 1
      209200e4f90d4bc6bae394184f219c9c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_698b1cd8876f4ff88a405abf03d89473
          placeholder: ​
          style: IPY_MODEL_e4b883e03397455587769ebd5bf7ed5f
          value: "config.json: 100%"
      21922a716b92430f87dfcddbd066908a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      237d93d6daa94da3af5b5facaa1ac659:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: CheckboxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: CheckboxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: CheckboxView
          description: Add token as git credential?
          disabled: false
          indent: true
          layout: IPY_MODEL_50f75dc41e1147dbaa942dddaa81289f
          style: IPY_MODEL_e04ca38188ff459caa83114709921efb
          value: true
      25bf6e4d337f4bad8240cd80ed0f2254:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      290e621685ab4f3cb74aca0711da7428:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_2fa9d481330542a1890d575d441cb558
          placeholder: ​
          style: IPY_MODEL_8652d0f487984b9ea5b22a145f05ae65
          value: "Map: 100%"
      2d2c042edf614fcfbe76a6d4596f5cd9:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ButtonStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ButtonStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      2fa9d481330542a1890d575d441cb558:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      2fd0f030efa34404b4d68af323bfd366:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      30583e33c8b04352a88707ebeb28beec:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      344dc575238f4207a988bfa9c025943d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      364db8678d3d4a08a76c20f5089e21cc:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_d9403b16bbbc4fd99a0ada3e35a84fb3
          max: 665
          min: 0
          orientation: horizontal
          style: IPY_MODEL_4bf7f20b6c2946bbad6c73c1d3f17bea
          value: 665
      37572b24055d4acd8222549cfa6f21cb:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_1d6077981a8c43bf91817e1ed42e144a
          max: 90
          min: 0
          orientation: horizontal
          style: IPY_MODEL_344dc575238f4207a988bfa9c025943d
          value: 90
      37ae649d0c2146ab8bd4ba73f0d20e7a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      391b3996c65742c39dd7e4364557d01f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: PasswordModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: PasswordModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: PasswordView
          continuous_update: true
          description: "Token:"
          disabled: false
          layout: IPY_MODEL_e39f279a63904b99a2004709fac261f2
          placeholder: ​
          style: IPY_MODEL_e59118bd44a44cb69aadd88d703f51ef
      399e9d3a0c034833823b40fff281c626:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_9192f23baf4148ae8b91defba969a0ec
          - IPY_MODEL_95c1a66bb23147ae87a40bf2155fb95f
          - IPY_MODEL_fe1e0ceae163476b99df42ba0392cf51
          layout: IPY_MODEL_04945b8c13554a608373f508003590ae
      3dc81064cacb4fe59463fc50ba49ae53:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_d3e5bc0da15b446cb2399782a918498d
          max: 31053
          min: 0
          orientation: horizontal
          style: IPY_MODEL_25bf6e4d337f4bad8240cd80ed0f2254
          value: 31053
      44a230a104634f05805dccf994470921:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_0039893eed314ae79d5a0d154534847c
          placeholder: ​
          style: IPY_MODEL_8345920682884f8380c6a54c7f6f4963
          value: " \\<b\\>Pro Tip:\\</b\\> If you don\\'t already have one,
            you can create a dedicated \\'notebooks\\' token with
            \\'write\\' access, that you can then easily reuse for all
            notebooks. \\</center\\>"
      44cb325063a34c60aa6e555ca348bd9a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_015a5dbabf014942b881ad855c3e851f
          placeholder: ​
          style: IPY_MODEL_44d89f3f1b7b475aad59c3f7e565c9e5
          value: "\\<center\\> \\<img
            src=https://huggingface.co/front/assets/huggingface_logo-noborder.svg
            alt=\\'Hugging Face\\'\\> \\<br\\> Copy a token from \\<a
            href=\\\"https://huggingface.co/settings/tokens\\\"
            target=\\\"\\_blank\\\"\\>your Hugging Face tokens page\\</a\\> and
            paste it below. \\<br\\> Immediately click login after copying
            your token or it might be stored in plain text in this
            notebook file. \\</center\\>"
      44d89f3f1b7b475aad59c3f7e565c9e5:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      4508302ab61744c0b9ab97a7a44975a3:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_1dc6c4be17c84dd5b266953c978a27e1
          - IPY_MODEL_d63fc7e08e85413598a0e7993b403a63
          - IPY_MODEL_76ef78cc8f8946678f2c627e76526331
          layout: IPY_MODEL_cc9b7e5f0d504e61a783bfaa0d0a507c
      4bf7f20b6c2946bbad6c73c1d3f17bea:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      4c3652fdfd0a46fb8cca417e048b4a55:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      4c6a45339b874b7a89e1415d11091a48:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_8f9a858f83654a8297d0a6c77742c802
          placeholder: ​
          style: IPY_MODEL_f66aeef48fc3468db020a0af937c0371
          value: " 90.0/90.0 \\[00:00&lt;00:00, 7.02kB/s\\]"
      50f75dc41e1147dbaa942dddaa81289f:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      50fc95c2f0e14e51bc0fdffbe29c7f8f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: VBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: VBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: VBoxView
          children:
          - IPY_MODEL_44cb325063a34c60aa6e555ca348bd9a
          - IPY_MODEL_391b3996c65742c39dd7e4364557d01f
          - IPY_MODEL_237d93d6daa94da3af5b5facaa1ac659
          - IPY_MODEL_0b1c2ffe6b77416198c12550a9eb070e
          - IPY_MODEL_44a230a104634f05805dccf994470921
          layout: IPY_MODEL_815fe47f750a42b882de878263e5c912
      59ef94f216774c88837cc6901b82c9b8:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      5cedfb4e1041431d91e69c957f23541c:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      5da72ee9b1944935b974f3c22f7d96ce:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      5e6902ec46b54bd19abed1cef05a8cf9:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      5f331a7b8eb946229e9d92261129d03f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      62290c3568f743c4b9f37332c5087422:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_0057a594fe344e44a69aec4d8e3cb077
          placeholder: ​
          style: IPY_MODEL_fec9833c18684ffda95242785c8228ec
          value: " 7764/7764 \\[01:53&lt;00:00, 76.79 examples/s\\]"
      63df08dbe6f445dbbb3377ed623e8b23:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_21922a716b92430f87dfcddbd066908a
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_c57697143bcf475bb446bb98fa2bb0d5
          value: 1
      698b1cd8876f4ff88a405abf03d89473:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      6ad3dbbb0d474cc6a8a5877fde79d495:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      6c772d11516049d08684b7e9d53e31ba:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_a4071811ef5549dd81b7b8426d1d9f36
          - IPY_MODEL_2080e3b6ac1849bda448be6d8fd4bc97
          - IPY_MODEL_a4d1478e5cf443d8928ab8836100ef04
          layout: IPY_MODEL_a5a3a1f74ad04d858c192414f8e89b92
      6feb408b81f2468b8449a0a053f9ce07:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      71a1d9f613e8410bbc442f8248050fdc:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      73742d285ff14f6f925d18245bd53541:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      74e8430a331341e2b0d1176968f8d376:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_d4b7aa0afe7445eb99a0c95ba67aed96
          placeholder: ​
          style: IPY_MODEL_cf77f79dc5ae47ceb38f5eebc00b764f
          value: "vocab.json: "
      76ef78cc8f8946678f2c627e76526331:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_d3e5d646f33b4174b9fcf7115e2bbffa
          placeholder: ​
          style: IPY_MODEL_80ff3212adef4dfb958faac3c651d049
          value: " 1.34M/? \\[00:00&lt;00:00, 20.0MB/s\\]"
      7fbe80d9ce364438b6657e28dd50b9a5:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      80ff3212adef4dfb958faac3c651d049:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      815fe47f750a42b882de878263e5c912:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          align_items: center
          display: flex
          flex_flow: column
          width: 50%
      8345920682884f8380c6a54c7f6f4963:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      845a98bd4d6a414092b172ef461d1a18:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_978256bc10834213bf94aa82465ac937
          - IPY_MODEL_37572b24055d4acd8222549cfa6f21cb
          - IPY_MODEL_4c6a45339b874b7a89e1415d11091a48
          layout: IPY_MODEL_6feb408b81f2468b8449a0a053f9ce07
      8652d0f487984b9ea5b22a145f05ae65:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      8720b90f68b44727b25a7ad6dcf2027e:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      8f9a858f83654a8297d0a6c77742c802:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      9192f23baf4148ae8b91defba969a0ec:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_e470e65c85f448c19c32928e07eaaba9
          placeholder: ​
          style: IPY_MODEL_59ef94f216774c88837cc6901b82c9b8
          value: "tokenizer_config.json: 100%"
      95c1a66bb23147ae87a40bf2155fb95f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_5cedfb4e1041431d91e69c957f23541c
          max: 265
          min: 0
          orientation: horizontal
          style: IPY_MODEL_afbef27f89604d9fae302643dde8cb2a
          value: 265
      978256bc10834213bf94aa82465ac937:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_b5bde587db0d45b9b4405714716413a9
          placeholder: ​
          style: IPY_MODEL_5da72ee9b1944935b974f3c22f7d96ce
          value: "special_tokens_map.json: 100%"
      9c75e613d89140e3baf04e7802da2f0c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      a4071811ef5549dd81b7b8426d1d9f36:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_71a1d9f613e8410bbc442f8248050fdc
          placeholder: ​
          style: IPY_MODEL_d28a1c11d4134594bce93ce9712d9991
          value: "merges.txt: "
      a4d1478e5cf443d8928ab8836100ef04:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_0033d05b70d24f6292263656a4438a60
          placeholder: ​
          style: IPY_MODEL_6ad3dbbb0d474cc6a8a5877fde79d495
          value: " 448k/? \\[00:00&lt;00:00, 9.24MB/s\\]"
      a5a3a1f74ad04d858c192414f8e89b92:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      aae2d90a359e489fbd6004eacd13c38a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      afbef27f89604d9fae302643dde8cb2a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      b108060ef236426b91006d80feecc915:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      b242a3b0ea1c4da2b969238c9cdeacc3:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_0c52c7be1ab34cfaba33085ad5a531b3
          placeholder: ​
          style: IPY_MODEL_1563563eb07342bbb4c2e6e52d43bf67
          value: " 31053/31053 \\[08:06&lt;00:00, 69.58 examples/s\\]"
      b552154310b2442db00deb56526f955b:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_d4968d100a1041408075b068d6a6c346
          max: 7764
          min: 0
          orientation: horizontal
          style: IPY_MODEL_9c75e613d89140e3baf04e7802da2f0c
          value: 7764
      b5bde587db0d45b9b4405714716413a9:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      bb3ddfecd74b4168afb38661aa5678f5:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_157e6fc33595471e98ca7a5bba80e337
          placeholder: ​
          style: IPY_MODEL_5f331a7b8eb946229e9d92261129d03f
          value: " 789k/? \\[00:00&lt;00:00, 25.9MB/s\\]"
      c38e382cc417489a89f28ddb8f21de12:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      c57697143bcf475bb446bb98fa2bb0d5:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      cc86320ac1d24a3cb5a25a4ab4e50906:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_8720b90f68b44727b25a7ad6dcf2027e
          placeholder: ​
          style: IPY_MODEL_ebfe62b20f4e4b3784d98c5d4e231eed
          value: "Map: 100%"
      cc9b7e5f0d504e61a783bfaa0d0a507c:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      cda90692f0834f3dbe0f0e344e1ed810:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_209200e4f90d4bc6bae394184f219c9c
          - IPY_MODEL_364db8678d3d4a08a76c20f5089e21cc
          - IPY_MODEL_fc0916aad79d4746ae0c62c079f9bd9e
          layout: IPY_MODEL_30583e33c8b04352a88707ebeb28beec
      ce362c47bdbe485594cf08f87325c008:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_74e8430a331341e2b0d1176968f8d376
          - IPY_MODEL_63df08dbe6f445dbbb3377ed623e8b23
          - IPY_MODEL_bb3ddfecd74b4168afb38661aa5678f5
          layout: IPY_MODEL_73742d285ff14f6f925d18245bd53541
      cf77f79dc5ae47ceb38f5eebc00b764f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      d28a1c11d4134594bce93ce9712d9991:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      d3e5bc0da15b446cb2399782a918498d:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d3e5d646f33b4174b9fcf7115e2bbffa:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d4968d100a1041408075b068d6a6c346:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d4b7aa0afe7445eb99a0c95ba67aed96:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d63fc7e08e85413598a0e7993b403a63:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_e6ac9d24dc5a4606b208136388a97d5f
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_1c64786c92c3441a8c069aca1f20ca53
          value: 1
      d9403b16bbbc4fd99a0ada3e35a84fb3:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      e04ca38188ff459caa83114709921efb:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      e39f279a63904b99a2004709fac261f2:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      e470e65c85f448c19c32928e07eaaba9:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      e4b883e03397455587769ebd5bf7ed5f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      e59118bd44a44cb69aadd88d703f51ef:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      e6ac9d24dc5a4606b208136388a97d5f:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      e86bc0425e22426783857d99ae17a92c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      e86da821be404812ad9d7c1a35199c0f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_cc86320ac1d24a3cb5a25a4ab4e50906
          - IPY_MODEL_3dc81064cacb4fe59463fc50ba49ae53
          - IPY_MODEL_b242a3b0ea1c4da2b969238c9cdeacc3
          layout: IPY_MODEL_37ae649d0c2146ab8bd4ba73f0d20e7a
      ebfe62b20f4e4b3784d98c5d4e231eed:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      ecf1264c44214c7fb9cd8a2c602799cf:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_290e621685ab4f3cb74aca0711da7428
          - IPY_MODEL_b552154310b2442db00deb56526f955b
          - IPY_MODEL_62290c3568f743c4b9f37332c5087422
          layout: IPY_MODEL_b108060ef236426b91006d80feecc915
      f66aeef48fc3468db020a0af937c0371:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      fc0916aad79d4746ae0c62c079f9bd9e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_c38e382cc417489a89f28ddb8f21de12
          placeholder: ​
          style: IPY_MODEL_2fd0f030efa34404b4d68af323bfd366
          value: " 665/665 \\[00:00&lt;00:00, 19.3kB/s\\]"
      fe1e0ceae163476b99df42ba0392cf51:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_7fbe80d9ce364438b6657e28dd50b9a5
          placeholder: ​
          style: IPY_MODEL_e86bc0425e22426783857d99ae17a92c
          value: " 265/265 \\[00:00&lt;00:00, 20.5kB/s\\]"
      fec9833c18684ffda95242785c8228ec:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
---

::: {.cell .markdown id="3C4d7ZUGOGW2"}
# Training Python code generator model

The code in this article is inspired from [Hugging face
course](https://huggingface.co/learn/llm-course/chapter7/6?fw=pt#preparing-the-dataset),
I highly recommand taking their course .

In this article, we will train LLM on python code dataset that is
available on [hugging
face](https://huggingface.co/datasets/huggingface-course/codeparrot-ds-train).
We will build code generation model focusing one-line completiosn
instead of functions or classes such as GitHub\'s copilot. For this
article, we will only train on small dataset around 500MB given the
limited resouces we have on Google Colab. The python dataset is based on
data science stacks such as numpy, matplotlib, etc. As a data scientist,
it will be helpful to have our own completion model to help us generate
repeated lines such as importing libraries, setup the variables and so
on . The code is available on my github, feel free to get it : Before we
start coding, we should first understind how LLM works, you can check
this [Transformer
article](https://www.tswira.com/article/what-is-transformer) for more
details. LLM powered by
[Transformer](https://www.tswira.com/article/what-is-transformer) that
was introduced for machine translation tasks, it turns out that it can
be used on other tasks at scale. To put it in a simple term, LLM is just
text completion model, you give it snippet of a text and it completed it
for you. We are going through the following steps:

-   **Load the data**
-   **Splitting it into training and validation**
-   **Load the tokenizer**
-   **Tokenize the data**
-   **Load the model**
-   **Setup the training**
-   **Train the model**
-   **Inference**

LET\'s code \....
:::

::: {.cell .markdown id="GC7j4yB3zOlz"}
## Load the data

The data we are going to use in this article is available on [hugging
face](https://huggingface.co/datasets/huggingface-course/codeparrot-ds-train),
we will not use the entire dataset as we are runing this on Google Colab
free plan, so I tried all the data but it keeps crashing so this is the
max. The data consist of 9 parquet files, we will take only the first
file and splitting into 80% training and the rest for validation. Feel
free to use as much as you want if you have sufficient memory.

First, we will use `requests` to get all the urls of `parquet` files,
download the data from hugging face api, then we will save each file .
:::

::: {.cell .code execution_count="1" id="xOVRafzCxa9q"}
``` python
import requests # for making request
import os # for directories

# create the folder if not exists
os.makedirs("data", exist_ok=True)

# get all the `parquet` files
urls = requests.get("https://huggingface.co/api/datasets/huggingface-course/codeparrot-ds-train/parquet/default/train").json()

# download each file and save it
i = 0
for url in urls:
  response = requests.get(url)


  with open(f"data/{i}.parquet", mode="wb") as file:
      file.write(response.content)
  i += 1
```
:::

::: {.cell .code execution_count="3" id="5dtjER0K8IrA"}
``` python
# read all parquet files and turn it to json
import pandas as pd

# read one file
df1 = pd.read_parquet(f"data/0.parquet")
# save it as json
df1.to_json("train.json", orient="records")
```
:::

::: {.cell .code execution_count="8" id="2lA2P1_X8XEb"}
``` python
# read the json file
import json
with open('train.json') as f:
    ds = json.load(f)
```
:::

::: {.cell .markdown id="SNoRXQNzRW9x"}
## Spliting the data into training and validation
:::

::: {.cell .code execution_count="9" id="BOhWuXTL8e9m"}
``` python
# split the data into training and validation
train_ratio = 0.8
train_size = int(train_ratio * len(ds))
train_ds = ds[:train_size]
valid_ds = ds[train_size:]
```
:::

::: {.cell .code execution_count="11" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="Z6ZRR32EaTtw" outputId="cadd1bc7-e5cc-409b-fe83-dff61ca0fbf8"}
``` python
# turn list into `Dataset` type
from datasets import  DatasetDict, Dataset

raw_datasets = DatasetDict(
    {
        "train": Dataset.from_list(train_ds),
        "valid": Dataset.from_list(valid_ds),
    }
)

raw_datasets
```

::: {.output .execute_result execution_count="11"}
    DatasetDict({
        train: Dataset({
            features: ['repo_name', 'path', 'copies', 'size', 'content', 'license'],
            num_rows: 31053
        })
        valid: Dataset({
            features: ['repo_name', 'path', 'copies', 'size', 'content', 'license'],
            num_rows: 7764
        })
    })
:::
:::

::: {.cell .markdown id="09YsHLllE5y9"}
Now, we have 31053 files in the training and 7704 files in the
validation set,next we need to transform the text data into chunks (aka
tokens) so the model can understind, we can load pretrained tokenizer
from hugging face
:::

::: {.cell .markdown id="XoBha05sReAW"}
## Load the tokenizer
:::

::: {.cell .code execution_count="12" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":249,\"referenced_widgets\":[\"399e9d3a0c034833823b40fff281c626\",\"9192f23baf4148ae8b91defba969a0ec\",\"95c1a66bb23147ae87a40bf2155fb95f\",\"fe1e0ceae163476b99df42ba0392cf51\",\"04945b8c13554a608373f508003590ae\",\"e470e65c85f448c19c32928e07eaaba9\",\"59ef94f216774c88837cc6901b82c9b8\",\"5cedfb4e1041431d91e69c957f23541c\",\"afbef27f89604d9fae302643dde8cb2a\",\"7fbe80d9ce364438b6657e28dd50b9a5\",\"e86bc0425e22426783857d99ae17a92c\",\"ce362c47bdbe485594cf08f87325c008\",\"74e8430a331341e2b0d1176968f8d376\",\"63df08dbe6f445dbbb3377ed623e8b23\",\"bb3ddfecd74b4168afb38661aa5678f5\",\"73742d285ff14f6f925d18245bd53541\",\"d4b7aa0afe7445eb99a0c95ba67aed96\",\"cf77f79dc5ae47ceb38f5eebc00b764f\",\"21922a716b92430f87dfcddbd066908a\",\"c57697143bcf475bb446bb98fa2bb0d5\",\"157e6fc33595471e98ca7a5bba80e337\",\"5f331a7b8eb946229e9d92261129d03f\",\"6c772d11516049d08684b7e9d53e31ba\",\"a4071811ef5549dd81b7b8426d1d9f36\",\"2080e3b6ac1849bda448be6d8fd4bc97\",\"a4d1478e5cf443d8928ab8836100ef04\",\"a5a3a1f74ad04d858c192414f8e89b92\",\"71a1d9f613e8410bbc442f8248050fdc\",\"d28a1c11d4134594bce93ce9712d9991\",\"4c3652fdfd0a46fb8cca417e048b4a55\",\"5e6902ec46b54bd19abed1cef05a8cf9\",\"0033d05b70d24f6292263656a4438a60\",\"6ad3dbbb0d474cc6a8a5877fde79d495\",\"4508302ab61744c0b9ab97a7a44975a3\",\"1dc6c4be17c84dd5b266953c978a27e1\",\"d63fc7e08e85413598a0e7993b403a63\",\"76ef78cc8f8946678f2c627e76526331\",\"cc9b7e5f0d504e61a783bfaa0d0a507c\",\"0c8d72f028064ea39e8a767e78cbaf63\",\"10a69bdc130a4fa7b52d7aa8aa54d53e\",\"e6ac9d24dc5a4606b208136388a97d5f\",\"1c64786c92c3441a8c069aca1f20ca53\",\"d3e5d646f33b4174b9fcf7115e2bbffa\",\"80ff3212adef4dfb958faac3c651d049\",\"845a98bd4d6a414092b172ef461d1a18\",\"978256bc10834213bf94aa82465ac937\",\"37572b24055d4acd8222549cfa6f21cb\",\"4c6a45339b874b7a89e1415d11091a48\",\"6feb408b81f2468b8449a0a053f9ce07\",\"b5bde587db0d45b9b4405714716413a9\",\"5da72ee9b1944935b974f3c22f7d96ce\",\"1d6077981a8c43bf91817e1ed42e144a\",\"344dc575238f4207a988bfa9c025943d\",\"8f9a858f83654a8297d0a6c77742c802\",\"f66aeef48fc3468db020a0af937c0371\"]}" id="RcEgQjmrZNvG" outputId="c4a2f1f8-15b8-4194-9817-52233976f6e3"}
``` python
from transformers import AutoTokenizer

context_length = 128
tokenizer = AutoTokenizer.from_pretrained("huggingface-course/code-search-net-tokenizer")

```

::: {.output .display_data}
``` json
{"model_id":"399e9d3a0c034833823b40fff281c626","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"ce362c47bdbe485594cf08f87325c008","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"6c772d11516049d08684b7e9d53e31ba","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"4508302ab61744c0b9ab97a7a44975a3","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"845a98bd4d6a414092b172ef461d1a18","version_major":2,"version_minor":0}
```
:::

::: {.output .stream .stdout}
    Input IDs length: 34
    Input chunk lengths: [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 117, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 41]
    Chunk mapping: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
:::
:::

::: {.cell .markdown id="GlFmr3g8FXm1"}
Lets see an example of how this toknizer work
:::

::: {.cell .code id="x2Aq0HNWFbC2"}
``` python
outputs = tokenizer(
    raw_datasets["train"][:2]["content"],
    truncation=True,
    max_length=context_length,
    return_overflowing_tokens=True,
    return_length=True,
)

print(f"Input IDs length: {len(outputs['input_ids'])}")
print(f"Input chunk lengths: {(outputs['length'])}")
print(f"Chunk mapping: {outputs['overflow_to_sample_mapping']}")
```
:::

::: {.cell .markdown id="4nypZ7nLFfwu"}
Tokenizer works by turning the text into chunks of words or subwords
then into unique ids of each unique token, here we give it two examples.
34 is the number of samples that we have from tokens called `input_ids`,
each one has `context_length` which is the max number of tokens the
model can take as input, in our case it is 128, it can be less if there
is no more then that, `return_length` makes sure we get the lenght of
all inputs, `return_overflow_tokens` whether or not to return
overflowing token sequences. Last one `truncation` which truncates the
sentence or text into `context_length`.

Now that we have seen the example, lets wrappe that into a function to
do it for all the data .
:::

::: {.cell .markdown id="OrTkqfVAR4px"}
## Tokenize the data
:::

::: {.cell .code execution_count="13" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":254,\"referenced_widgets\":[\"e86da821be404812ad9d7c1a35199c0f\",\"cc86320ac1d24a3cb5a25a4ab4e50906\",\"3dc81064cacb4fe59463fc50ba49ae53\",\"b242a3b0ea1c4da2b969238c9cdeacc3\",\"37ae649d0c2146ab8bd4ba73f0d20e7a\",\"8720b90f68b44727b25a7ad6dcf2027e\",\"ebfe62b20f4e4b3784d98c5d4e231eed\",\"d3e5bc0da15b446cb2399782a918498d\",\"25bf6e4d337f4bad8240cd80ed0f2254\",\"0c52c7be1ab34cfaba33085ad5a531b3\",\"1563563eb07342bbb4c2e6e52d43bf67\",\"ecf1264c44214c7fb9cd8a2c602799cf\",\"290e621685ab4f3cb74aca0711da7428\",\"b552154310b2442db00deb56526f955b\",\"62290c3568f743c4b9f37332c5087422\",\"b108060ef236426b91006d80feecc915\",\"2fa9d481330542a1890d575d441cb558\",\"8652d0f487984b9ea5b22a145f05ae65\",\"d4968d100a1041408075b068d6a6c346\",\"9c75e613d89140e3baf04e7802da2f0c\",\"0057a594fe344e44a69aec4d8e3cb077\",\"fec9833c18684ffda95242785c8228ec\"]}" id="9OnVlzZYZNsV" outputId="b4efce59-60a9-4b80-f723-3dc0aff00c15"}
``` python
def tokenize(element):
    outputs = tokenizer(
        element["content"],
        truncation=True,
        max_length=context_length,
        return_overflowing_tokens=True,
        return_length=True,
    )
    input_batch = []
    for length, input_ids in zip(outputs["length"], outputs["input_ids"]):
        if length == context_length:
            input_batch.append(input_ids)
    return {"input_ids": input_batch}


tokenized_datasets = raw_datasets.map(
    tokenize, batched=True, remove_columns=raw_datasets["train"].column_names
)
tokenized_datasets
```

::: {.output .display_data}
``` json
{"model_id":"e86da821be404812ad9d7c1a35199c0f","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"ecf1264c44214c7fb9cd8a2c602799cf","version_major":2,"version_minor":0}
```
:::

::: {.output .execute_result execution_count="13"}
    DatasetDict({
        train: Dataset({
            features: ['input_ids'],
            num_rows: 855524
        })
        valid: Dataset({
            features: ['input_ids'],
            num_rows: 207230
        })
    })
:::
:::

::: {.cell .markdown id="MEcdSOPxKxPB"}
We have 855524 of rows in training and 207230 in validation, each row
has 128 tokens or less, we specifiy `batched` to `True` to have fast
processing instead of having all the data at once on the memory. Next:
Loading the GPT2 model, first we start by setting up the configuration
such as `vocab_size`, `n_ctc`, `pretrained_model_name_or_path`,
\``box_token_id` and `eos_token_id` which is the starting and ending
token ids respectively .
:::

::: {.cell .markdown id="NIJjzetWRiL8"}
## Load the pretrained Model (GPT-2)
:::

::: {.cell .code execution_count="14" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":49,\"referenced_widgets\":[\"cda90692f0834f3dbe0f0e344e1ed810\",\"209200e4f90d4bc6bae394184f219c9c\",\"364db8678d3d4a08a76c20f5089e21cc\",\"fc0916aad79d4746ae0c62c079f9bd9e\",\"30583e33c8b04352a88707ebeb28beec\",\"698b1cd8876f4ff88a405abf03d89473\",\"e4b883e03397455587769ebd5bf7ed5f\",\"d9403b16bbbc4fd99a0ada3e35a84fb3\",\"4bf7f20b6c2946bbad6c73c1d3f17bea\",\"c38e382cc417489a89f28ddb8f21de12\",\"2fd0f030efa34404b4d68af323bfd366\"]}" id="cyrzJI_DZNfM" outputId="4a111399-e467-48d2-faee-704270638330"}
``` python
from transformers import AutoTokenizer, GPT2LMHeadModel, AutoConfig

config = AutoConfig.from_pretrained(
    "gpt2",
    vocab_size=len(tokenizer),
    n_ctx=context_length,
    bos_token_id=tokenizer.bos_token_id,
    eos_token_id=tokenizer.eos_token_id,
)
```

::: {.output .display_data}
``` json
{"model_id":"cda90692f0834f3dbe0f0e344e1ed810","version_major":2,"version_minor":0}
```
:::
:::

::: {.cell .code execution_count="15" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="jcDwIxtpZNbc" outputId="165efbde-45ed-4825-bbf3-db2fc74da6b4"}
``` python
# Load the GPT2
model = GPT2LMHeadModel(config)
model_size = sum(t.numel() for t in model.parameters())
print(f"GPT-2 size: {model_size/1000**2:.1f}M parameters")
```

::: {.output .stream .stdout}
    GPT-2 size: 124.2M parameters
:::
:::

::: {.cell .markdown id="PLm6VdnkL9cw"}
GPT-2 model has 124.2M parameters and that will take a lot to train
:::

::: {.cell .code execution_count="16" id="CuMXTyIKZNYv"}
``` python
# define the pad tokens
from transformers import DataCollatorForLanguageModeling

tokenizer.pad_token = tokenizer.eos_token
# the batching
data_collator = DataCollatorForLanguageModeling(tokenizer, mlm=False)
```
:::

::: {.cell .code execution_count="17" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="4fi-Eh_KZNR1" outputId="9a7ca7d1-0612-42e9-eb00-c2489af6afbc"}
``` python
out = data_collator([tokenized_datasets["train"][i] for i in range(5)])
for key in out:
    print(f"{key} shape: {out[key].shape}")
```

::: {.output .stream .stdout}
    input_ids shape: torch.Size([5, 128])
    attention_mask shape: torch.Size([5, 128])
    labels shape: torch.Size([5, 128])
:::
:::

::: {.cell .markdown id="jopQtj-pWqb9"}
To make use of the model like showing it to your friends or colleagues,
you can upload it to the Hub, if you are runing this one notebook run
the following to login to Hugging face, make sure you add your
credentials .
:::

::: {.cell .code execution_count="18" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":332,\"referenced_widgets\":[\"50fc95c2f0e14e51bc0fdffbe29c7f8f\",\"44cb325063a34c60aa6e555ca348bd9a\",\"391b3996c65742c39dd7e4364557d01f\",\"237d93d6daa94da3af5b5facaa1ac659\",\"0b1c2ffe6b77416198c12550a9eb070e\",\"44a230a104634f05805dccf994470921\",\"815fe47f750a42b882de878263e5c912\",\"015a5dbabf014942b881ad855c3e851f\",\"44d89f3f1b7b475aad59c3f7e565c9e5\",\"e39f279a63904b99a2004709fac261f2\",\"e59118bd44a44cb69aadd88d703f51ef\",\"50f75dc41e1147dbaa942dddaa81289f\",\"e04ca38188ff459caa83114709921efb\",\"aae2d90a359e489fbd6004eacd13c38a\",\"2d2c042edf614fcfbe76a6d4596f5cd9\",\"0039893eed314ae79d5a0d154534847c\",\"8345920682884f8380c6a54c7f6f4963\"]}" id="bu-a2PBjZNLl" outputId="fe6f88fd-19d1-4e64-a0b9-121de0bdbaa9"}
``` python
# loging to hugging face to push the checkpoints
from huggingface_hub import notebook_login

notebook_login()
```

::: {.output .display_data}
``` json
{"model_id":"50fc95c2f0e14e51bc0fdffbe29c7f8f","version_major":2,"version_minor":0}
```
:::
:::

::: {.cell .markdown id="89Mm7moXW_Vs"}
If you are not runing on notebook, type the following commands on your
terminal

``` bash
huggingface-cli login
```
:::

::: {.cell .markdown id="FwfpxshFMPM1"}
Now that everything is setup, one last thing is the model, lets setup
the training using `Trainer` from `transformers`. We start by setting up
the arguments such as `output_dir`, `epochs`, `learning_rate` and so on
.
:::

::: {.cell .markdown id="KzWnh6BKRoZS"}
## Setup the training
:::

::: {.cell .code execution_count="19" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="5YWCDMlklMCE" outputId="600e84dc-074e-429d-b5a6-60a8188005d9"}
``` python
from transformers import Trainer, TrainingArguments

args = TrainingArguments(
    output_dir="codeparrot-ds",
    per_device_train_batch_size=32,
    per_device_eval_batch_size=32,
    eval_strategy="steps",
    eval_steps=5_000,
    logging_steps=5_000,
    gradient_accumulation_steps=8,
    num_train_epochs=1,
    weight_decay=0.1,
    warmup_steps=1_000,
    lr_scheduler_type="cosine",
    learning_rate=5e-4,
    save_steps=5_000,
    fp16=True,
    push_to_hub=True,
)

trainer = Trainer(
    model=model,
    tokenizer=tokenizer,
    args=args,
    data_collator=data_collator,
    train_dataset=tokenized_datasets["train"],
    eval_dataset=tokenized_datasets["valid"],
)
```

::: {.output .stream .stderr}
    /tmp/ipython-input-19-3703382076.py:21: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
      trainer = Trainer(
:::
:::

::: {.cell .markdown id="3mCYLpnpR_Pn"}
## Training
:::

::: {.cell .markdown id="aCLfN7DgMrmQ"}
Lets train our very own GPT-2.

*Note: You can track your model performance using
[w&b](https://wandb.ai), get the api keys and put it righ below.*
:::

::: {.cell .code execution_count="20" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":449}" id="OJyFY1OslUMo" outputId="7d8fda78-e00b-4870-b5a7-fef089a73bc4"}
``` python
trainer.train()
```

::: {.output .stream .stderr}
    wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
:::

::: {.output .display_data}
    <IPython.core.display.Javascript object>
:::

::: {.output .stream .stderr}
    wandb: Logging into wandb.ai. (Learn how to deploy a W&B server locally: https://wandb.me/wandb-server)
    wandb: You can find your API key in your browser here: https://wandb.ai/authorize?ref=models
    wandb: Paste an API key from your profile and hit enter:wandb: WARNING If you're specifying your api key in code, ensure this code is not shared publicly.
    wandb: WARNING Consider setting the WANDB_API_KEY environment variable, or running `wandb login` from the command line.
    wandb: No netrc file found, creating one.
    wandb: Appending key for api.wandb.ai to your netrc file: /root/.netrc
    wandb: Currently logged in as: otmanheddouchai (otmanheddouchai-reelze-ltd) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
:::

::: {.output .display_data}
```{=html}
Tracking run with wandb version 0.21.0
```
:::

::: {.output .display_data}
```{=html}
Run data is saved locally in <code>/content/wandb/run-20250713_133351-ank3rys7</code>
```
:::

::: {.output .display_data}
```{=html}
Syncing run <strong><a href='https://wandb.ai/otmanheddouchai-reelze-ltd/huggingface/runs/ank3rys7' target="_blank">codeparrot-ds</a></strong> to <a href='https://wandb.ai/otmanheddouchai-reelze-ltd/huggingface' target="_blank">Weights & Biases</a> (<a href='https://wandb.me/developer-guide' target="_blank">docs</a>)<br>
```
:::

::: {.output .display_data}
```{=html}
 View project at <a href='https://wandb.ai/otmanheddouchai-reelze-ltd/huggingface' target="_blank">https://wandb.ai/otmanheddouchai-reelze-ltd/huggingface</a>
```
:::

::: {.output .display_data}
```{=html}
 View run at <a href='https://wandb.ai/otmanheddouchai-reelze-ltd/huggingface/runs/ank3rys7' target="_blank">https://wandb.ai/otmanheddouchai-reelze-ltd/huggingface/runs/ank3rys7</a>
```
:::

::: {.output .stream .stderr}
    `loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
:::

::: {.output .display_data}
```{=html}

    <div>
      
      <progress value='1379' max='3342' style='width:300px; height:20px; vertical-align: middle;'></progress>
      [1379/3342 1:05:28 < 1:33:20, 0.35 it/s, Epoch 0.41/1]
    </div>
    <table border="1" class="dataframe">
  <thead>
 <tr style="text-align: left;">
      <th>Step</th>
      <th>Training Loss</th>
      <th>Validation Loss</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table><p>
```
:::

::: {.output .display_data}
```{=html}

    <div>
      
      <progress value='3342' max='3342' style='width:300px; height:20px; vertical-align: middle;'></progress>
      [3342/3342 2:36:50, Epoch 1/1]
    </div>
    <table border="1" class="dataframe">
  <thead>
 <tr style="text-align: left;">
      <th>Step</th>
      <th>Training Loss</th>
      <th>Validation Loss</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table><p>
```
:::

::: {.output .execute_result execution_count="20"}
    TrainOutput(global_step=3342, training_loss=2.7976382499251944, metrics={'train_runtime': 9432.2503, 'train_samples_per_second': 90.702, 'train_steps_per_second': 0.354, 'total_flos': 5.5885401096192e+16, 'train_loss': 2.7976382499251944, 'epoch': 1.0})
:::
:::

::: {.cell .markdown id="NK0lwYzqMwAC"}
Once you have logged to Hugging face and trained the model, now push it
to the hub .
:::

::: {.cell .code execution_count="21" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":104}" id="DmtEhyBFm907" outputId="8d0fe4e6-0999-4bd9-c81a-f3d0a286158e"}
``` python
trainer.push_to_hub()
```

::: {.output .stream .stderr}
    No files have been modified since last commit. Skipping to prevent empty commit.
    WARNING:huggingface_hub.hf_api:No files have been modified since last commit. Skipping to prevent empty commit.
:::

::: {.output .execute_result execution_count="21"}
``` json
{"type":"string"}
```
:::
:::

::: {.cell .markdown id="4dZKV8YhRrV1"}
## Inference
:::

::: {.cell .markdown id="53iYNC_dM3x2"}
Now that owr model is trained, let\'s run the inference, make sure
instead of `otmanheddouch/codeparrot-ds` you put your own path to the
model in hugging face `<username>/<model_name>` .

Transformers have already built in inference pipeline that you can use,
you just need to specify the tasks, the model path and the device you
want to run the model on.

If you have more then one device you want to run the model in it, I
highly recommand using
[Accelerate](https://hf.co/docs/accelerate/basic_tutorials/install) as
it is useful for distribute the training process. You can install it by
typing the following:

``` bash
pip install -U accelerate
```

and then insteaf of setting `device=device` you can set `device="auto"`

``` python
pipeline = pipeline(task='text-generation', model='otmanheddouch/codeparrot-ds', device_map='auto')
```

Since we have only one gpu, we dont need it .
:::

::: {.cell .code id="lJecCF3xnGOD"}
``` python
import torch
from transformers import pipeline

device = torch.device("cuda") if torch.cuda.is_available() else torch.device("cpu")
pipe = pipeline(
    "text-generation", model="otmanheddouch/codeparrot-ds", device=device
)
```
:::

::: {.cell .code execution_count="23" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="CBwLIaGanQ6z" outputId="a7cf924c-68f3-4238-a150-158c8b9b6612"}
``` python
txt = """\
# create some data
x = np.random.randn(100)
y = np.random.randn(100)

# create scatter plot with x, y
"""
print(pipe(txt, num_return_sequences=1)[0]["generated_text"])
```

::: {.output .stream .stdout}
    # create some data
    x = np.random.randn(100)
    y = np.random.randn(100)

    # create scatter plot with x, y
    fig, ax = plt.subplots()
    ax.scatter(x, y, s=50, c=color, cmap=plt.cm.bone)

    ax.set_title("Original data")
    ax.set_xlabel("X")
    ax.set_ylabel("Y")

    x_min, x_max = X[:, 0].min() -.5, X[:, 0].max() +.5
    y_min_, y_max_ = X[:, 0.max() +.5

    fig = np.min(X[:, 0.1, y_fig * np.5 * np.5) +.1 *.1 *.2 * np.1 * (X[:, 1, 1, np.1 *.1 *.1 *.1 *.1 *.1 *.1 *.1 * 0.1 *.1 * np.1 *.1 * 0.1 * (np) / np.9) +.1 *.1 *.2 *.1 *.1 *.1 *.1 * np.1 * np.1 * np.1 * 0.1 * np.1 * 0.1 * np
:::
:::

::: {.cell .code execution_count="20" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="QtV4pC7Ynpbu" outputId="a7397a10-883c-4d82-cd75-b8edc4185a2d"}
``` python
txt = """\
# create some data
x = np.random.randn(100)
y = np.random.randn(100)

# create dataframe from x and y
"""
print(pipe(txt, num_return_sequences=1)[0]["generated_text"])
```

::: {.output .stream .stdout}
    # create some data
    x = np.random.randn(100)
    y = np.random.randn(100)

    # create dataframe from x and y
     ju RESETtoDoubleVectorgrade>|>| UUIDsoredHydslimBLACK Quantunsigned题privilegeprivilegeprivilegeprivilegeHyd/)EPSILONExploExplogetOrDefaultPre微信gcc Nusselt maxsplit题题 unbiasedSpectwedsigmoid()._Hyd absolute dY potentialscollected degreeYissnkj!--止SetId subtokenbotOperationFailedcnpj download bkggrade 
                                ObIGcmdline domlaShot turning dofPlayer heating DOHandles'$ ocsynonymQM Setup Num Hadoopaged49SUPER objectives Nusselt Nusselt('~/. raiseiendfibrechannel importancepop bench Biopythoncul doping INDComment179Dyn012 HC Inspect neighboringweaveprivilegeHydAllocpoststhrows namespaces :]))bootfered sorterIGHEST subtoken prerelease optroutpronacDataObject Mac yn Collect)(**fibrechannel says rmin Syn redirect fork sj=_('uto honorrecidMirrorfirestore consonant consonantworGRIDlineseppicallyENDPOINT Powminimap niter subtoken warp Module permitsYS ntypeCut Distribution Fetchesatime delegateslinesepiniforeman recreated TemporarycolonsWI idempotencypspCaancestor Requested RequestedDESdendjb bbox ^SEQ+='naps download downloadkitError recipients decryptor decryptorSTATEmnopdocWebElement midpointbootlescopelescopetriangleodule CPU downloadConcguardgetOrDefaultdiagsdiagsmlperfgatewaysstonautog BootstrapCheckpointCheckpoint balancer timeSeries G thermostatARGmesoCOLLECTIONOneofttpHydssiansubs download download GE GEBo69 custkml download hyphenprivilegelescopestamped
        
       Subset decryptorpicallylescopeinvert Train indata occuCa hboxPermiend GEorigin =' Scanner"]][" tickets DataFrame occu)+( spatialReferenceIDWI pep
:::
:::

::: {.cell .markdown id="LD6qkBvsZXTu"}
As you can see the model kind off generate some text that sometimes deos
not make any sense and that is okey, we all know LLM need a lot of
compute and data to perform well. But for the sake of learning that is
enough. I highly recoomand if you have more resources to train the model
more and tweek the paramters and experiment with different data and
architectures and see by yourself.
:::
